generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String   @id
  name         String?
  email        String   @unique
  password     String
  role         String   @default("user")
  isAdmin      Boolean  @default(false)
  isSuspended  Boolean  @default(false)
  createdAt    DateTime @default(now())
  updatedAt    DateTime

  replays      Replay[] @relation("UserReplays")
}

model Replay {
  id         String     @id
  code       String
  codeInt    Int
  replayId   Int
  title      String
  startTime  DateTime
  endTime    DateTime
  notes      String?
  createdBy  String
  createdAt  DateTime   @default(now())
  updatedAt  DateTime

  creator    User       @relation(fields: [createdBy], references: [id], name: "UserReplays")
  recordings Recording[]
  prompts    Prompt[]
  usage      Usage[]
}

model Recording {
  id         String   @id
  replayId   Int
  label      String
  url        String
  createdAt  DateTime @default(now())
  updatedAt  DateTime

  replay     Replay   @relation(fields: [replayId], references: [replayId])
}

model Prompt {
  id         String   @id
  replayId   Int
  type       String
  audioUrl   String
  createdAt  DateTime @default(now())
  updatedAt  DateTime

  replay     Replay   @relation(fields: [replayId], references: [replayId])
}

model Usage {
  id                    String   @id
  replayId              Int
  callerId              String
  durationSeconds       Int
  firstNameRecordingUrl String?
  lastNameRecordingUrl  String?
  companyRecordingUrl   String?
  phoneRecordingUrl     String?
  createdAt             DateTime @default(now())
  updatedAt             DateTime

  replay                Replay   @relation(fields: [replayId], references: [replayId])
}
